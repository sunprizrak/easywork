#:import MainScreen screens
#:import Window kivy.core.window.Window
#:import MDActionBottomAppBarButton kivymd.uix.toolbar.MDActionBottomAppBarButton
#:import os os


<MainScreen>
    name: 'main_screen'

    table: table_screen
    max_width: dp(1220)

    MDFloatLayout:
        id: main_layout

        MDBoxLayout:
            id: table_box
            padding: [dp(10), dp(10), dp(10), 0] if Window.width < root.max_width else [dp(10), dp(10), dp(10), dp(10)]
            size_hint_x: None if Window.width >= root.max_width else 1
            width: root.max_width if Window.width >= root.max_width else self.width
            size_hint_y: None
            height: Window.height - tools.height  if Window.width < root.max_width else Window.height - tools.height
            pos_hint: {'top': 1}

            MDData:
                id: table_screen

        MDBoxLayout:
            orientation: 'vertical'
            padding: [dp(10), dp(10), dp(10), dp(10)]
            size_hint: None, None
            width: Window.width - table_box.width
            height: Window.height - tools.height
            pos_hint: {'right': 1, 'top': 1}
            adaptive_height: True

            MDBoxLayout:
                orientation: 'vertical'
                size_hint_y: .45

                Image:
                    id: screenshot
                    source: os.sep.join(['assets', 'img', 'chost_image.png'])
                    mipmap: True

            MDBoxLayout:
                orientation: 'horizontal'
                spacing: dp(30)
                size_hint_y: .55

                MDBoxLayout:
                    id: fields_box
                    orientation: 'vertical'
                    spacing: dp(7)
                    size_hint_x: .6
                    pos_hint: {'center_x': .5}
                    adaptive_height: True

                MDBoxLayout:
                    id: buttons_box
                    orientation: 'vertical'
                    spacing: dp(15)
                    size_hint_x: .4
                    adaptive_height: True

        MDBoxLayout:
            id: tools
            orientation: 'vertical' if Window.width < root.max_width else 'horizontal'
            padding: [dp(10), 0, dp(10), 0]
            spacing: dp(10)
            adaptive_height: True

            MDBoxLayout:
                orientation: 'horizontal'
                adaptive_height: True

                MDBoxLayout:
                    orientation: 'horizontal'
                    adaptive_height: True

                    MDIconButton:
                        icon: "cog"
                        theme_text_color: "Custom"
                        color: 'white'
                        on_release:
                            root.open_settings()

                    MDIconButton:
                        icon: "image-plus"
                        theme_text_color: "Custom"
                        color: 'white'
                        on_release:
                            root.file_manager_open()

                    MDLabel:
                        text: root.path
                        adaptive_width: True

                MDBoxLayout:
                    orientation: 'horizontal'
                    spacing: dp(10)
                    pos_hint: {'center_y': .5} if Window.width >= root.max_width else {'bottom': 1}
                    adaptive_size: True

                    MDRaisedButton:
                        text: 'Delete img'
                        font_style: 'Button'
                        md_bg_color: 'purple'
                        on_release:
                            root.delete_img()

                    MDRaisedButton:
                        text: 'Delete Rows'
                        font_style: 'Button'
                        md_bg_color: 'purple'
                        on_release:
                            root.table.delete_checked_rows()

            MDBoxLayout:
                orientation: 'horizontal'
                spacing: dp(30)
                padding: [0, 0, 0, dp(5)]
                size_hint_x: None if Window.width >= root.max_width else 1
                width: Window.width - table_box.width if Window.width >= root.max_width else self.width
                pos_hint: {'y': 0} if Window.width < root.max_width else {'right': 1}
                adaptive_height: True

                MDRaisedButton:
                    id: button_start
                    text: "Start"
                    font_style: 'Button'
                    md_bg_color: "green"
                    size_hint_x: .5
                    disabled: False
                    on_release:
                        root.start(self)


                MDRaisedButton:
                    text: "Push To Google Sheet"
                    font_style: 'Button'
                    md_bg_color: "blue"
                    size_hint_x: .5
                    disabled: False if table_screen.data_tables.row_data else True
                    on_release:
                        root.push(self)

        MDSpinner:
            id: main_spin
            size_hint: None, None
            size: dp(38), dp(38)
            pos_hint: {'center_x': .5, 'center_y': .5} if Window.width < root.max_width else {'center_x': .3, 'center_y': .5}
            active: False






